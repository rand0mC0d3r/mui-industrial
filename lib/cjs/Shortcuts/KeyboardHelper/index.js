"use strict";var __assign=this&&this.__assign||function(){return(__assign=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},__importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0});var jsx_runtime_1=require("react/jsx-runtime"),material_1=require("@mui/material"),react_1=require("react"),Store_1=__importDefault(require("../../Store")),Component_1=__importDefault(require("./Component")),css_1=require("./css"),shortcutString=function(e){return[(null==e?void 0:e.shiftKey)&&"⇧",(null==e?void 0:e.ctrlKey)&&"⌃",(null==e?void 0:e.altKey)&&"⌥",(null==e?void 0:e.metaKey)&&"⌘",null==e?void 0:e.char,(null==e?void 0:e.ascii)&&"Ascii ".concat(e.ascii)].filter(Boolean).join(" ")},shortcutStringNg=function(e){return(0,jsx_runtime_1.jsx)(css_1.StyledListOfKeys,{children:[(null==e?void 0:e.shiftKey)&&"⇧",(null==e?void 0:e.ctrlKey)&&"⌃",(null==e?void 0:e.altKey)&&"⌥",(null==e?void 0:e.metaKey)&&"⌘",null==e?void 0:e.char,(null==e?void 0:e.ascii)&&"Ascii (".concat(e.ascii,")")].filter(Boolean).map(function(e){return(0,jsx_runtime_1.jsx)(css_1.StyledKey,__assign({ascii:(e||"").includes("(").toString(),elevation:1},{children:e}),"char-".concat(e))})})},baseTooltip=function(e){return"".concat(e&&"".concat(e.label," -")," ").concat(shortcutString(e))};exports.default=function(e){var t,n=e.shortcutId,i=e.asChip,r=void 0!==i&&i,s=e.hasTooltip,o=void 0!==s&&s,a=e.hasOverride,l=void 0!==a&&a,u=e.style,c=(0,react_1.useContext)(Store_1.default).shortcuts,_=(0,react_1.useState)(),d=_[0],p=_[1],h=(0,react_1.useState)(null),f=h[0],m=h[1],g=(0,react_1.useState)(baseTooltip),v=g[0],x=g[1],j=Boolean(f),y=j?"simple-popover":void 0,S=function(){m(null)},K=(0,jsx_runtime_1.jsx)("div",__assign({style:{userSelect:"none",display:"flex",alignItems:"center",gap:"4px"}},{children:shortcutStringNg(d)})),O=(0,jsx_runtime_1.jsx)(material_1.Typography,__assign({style:__assign(__assign({},u),{userSelect:"none",lineHeight:"1",display:"flex",alignItems:"center"}),variant:"caption",color:"inherit"},{children:shortcutString(d)}));return(0,react_1.useEffect)(function(){var e=baseTooltip(d);x(function(){return l?"".concat(e," - Right-Click to Override"):e})},[l,d]),(0,react_1.useEffect)(function(){p(c.find(function(e){return e.id===n}))},[n,c]),(0,jsx_runtime_1.jsx)(jsx_runtime_1.Fragment,{children:n&&d&&function(e){return l?(0,jsx_runtime_1.jsxs)(css_1.StyledOverrideWrapper,__assign({onContextMenu:function(e){e.preventDefault(),m(e.currentTarget)}},{children:[d&&(0,jsx_runtime_1.jsx)(Component_1.default,__assign({},{idPopper:y,anchorEl:f,open:j,handleClose:S,shortcutId:n,shortcutObject:d})),e]})):e}((t=r?K:O,o||l?(0,jsx_runtime_1.jsx)(material_1.Tooltip,__assign({title:(0,jsx_runtime_1.jsx)("span",__assign({style:{userSelect:"none"}},{children:v})),placement:"right",arrow:!0},{children:(0,jsx_runtime_1.jsx)("span",__assign({style:u},{children:t}))})):t))})};