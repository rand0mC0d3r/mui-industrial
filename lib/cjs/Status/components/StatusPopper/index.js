"use strict";var __assign=this&&this.__assign||function(){return(__assign=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},__importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0});var jsx_runtime_1=require("react/jsx-runtime"),react_1=require("react"),index_types_1=require("../../../index.types"),Store_1=__importDefault(require("../../../Store")),StatusCore_1=__importDefault(require("../StatusCore")),Component_1=__importDefault(require("./Component")),defaultPopperOptions={elevation:2,hasToolbar:!0,onClose:function(){},open:!1,hasArrow:!1,hasDecoration:!1},defaultSeparatorOptions={start:!1,end:!1};exports.default=function(e){var t=e.id,n=e.order,r=e.disabled,o=e.highlight,i=void 0===o?index_types_1.Highlight.DEFAULT:o,s=e.options,a=e.secondary,u=void 0!==a&&a,l=e.tooltip,_=void 0===l?"":l,p=e.onClick,c=e.onContextMenu,d=e.style,f=e.className,h=e.children,g=(0,react_1.useState)(null),v=g[0],x=g[1],m=(0,react_1.useState)(null),j=m[0],y=m[1],O=(0,react_1.useState)(!1),C=O[0],S=O[1],b=(0,react_1.useContext)(Store_1.default).status,q=(0,react_1.useRef)(),D=__assign(__assign({},defaultPopperOptions),null==s?void 0:s.popper),E=__assign(__assign({},defaultSeparatorOptions),null==s?void 0:s.separators);(0,react_1.useEffect)(function(){var e=b.find(function(e){return e.uniqueId===t});e&&x(e)},[b,t]),(0,react_1.useEffect)(function(){j||S(!1)},[j]),(0,react_1.useEffect)(function(){(null==s?void 0:s.open)&&S(null==s?void 0:s.open)},[s.open]),(0,react_1.useEffect)(function(){s.open?(null==q?void 0:q.current)&&y(q.current):(null==v?void 0:v.keepOpen)||y(null)},[v,s]);return(0,jsx_runtime_1.jsxs)(jsx_runtime_1.Fragment,{children:[(0,jsx_runtime_1.jsx)(StatusCore_1.default,__assign({},{ref:q,onLoad:function(e){y(e.current)},id:t,order:n,disabled:r,tooltip:s.open?null:_,highlight:(null!=v&&v.keepOpen||void 0!==s.open)&&s.open?index_types_1.Highlight.PRIMARY:i,secondary:u,options:{separators:E,popper:__assign(__assign({},D),{hasArrow:s.open&&D.hasArrow})},onClick:function(e){null!=v&&v.keepOpen||(p&&p(e),y(C?null:null==e?void 0:e.currentTarget),S(function(e){return!e}))},onContextMenu:c,style:__assign(__assign({},d),{cursor:(null==v?void 0:v.keepOpen)?"not-allowed":"pointer"}),className:f},{children:h})),(0,jsx_runtime_1.jsx)(Component_1.default,__assign({},{id:t,enrichedPopper:D,highlight:i,statusObject:v,open:C,anchorEl:j,setAnchorEl:y,options:s,secondary:u}))]})};