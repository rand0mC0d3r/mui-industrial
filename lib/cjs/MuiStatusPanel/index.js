"use strict";var __assign=this&&this.__assign||function(){return(__assign=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var r in t=arguments[i])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},__importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0});var jsx_runtime_1=require("react/jsx-runtime"),LockOpenOutlined_1=__importDefault(require("@mui/icons-material/LockOpenOutlined")),LockOutlined_1=__importDefault(require("@mui/icons-material/LockOutlined")),material_1=require("@mui/material"),styles_1=require("@mui/material/styles"),react_1=require("react"),MuiStatus_1=__importDefault(require("../MuiStatus")),MuiStore_1=__importDefault(require("../MuiStore")),StyledActionsWrapper=(0,styles_1.styled)("div")(function(e){var t=e.theme;return{padding:"8px",display:"flex",justifyContent:"space-between",borderTop:"1px solid ".concat(t.palette.divider),userSelect:"none",alignItems:"center"}}),StyledActions=(0,styles_1.styled)("div")(function(e){var t=e.theme;return{display:"flex",gap:"".concat(t.shape.borderRadius,"px"),justifyContent:"flex-end",alignItems:"center"}}),StyledContainer=(0,styles_1.styled)("div")(function(e){var t=e.theme,i=e.elevation;return{display:"flex",alignItems:"stretch",flexDirection:"column",backgroundColor:"".concat((0,material_1.alpha)(t.palette.background.default,.75)),backdropFilter:"blur(8px)",borderRadius:"".concat(t.shape.borderRadius,"px"),margin:"".concat(t.spacing(.5)," 0px"),padding:t.spacing(.5),border:"1px solid ".concat(t.palette.divider),boxShadow:t.shadows[i]}}),StyledTypography=(0,styles_1.styled)(material_1.Typography)(function(){return{lineHeight:1}});function default_1(e){var t=e.id,i=e.secondary,n=void 0!==i&&i,r=e.elevation,a=void 0===r?2:r,s=e.style,o=e.onClick,l=e.onClose,u=e.highlight,c=e.tooltip,_=void 0===c?"":c,d=e.children,p=e.popoverStyle,m=e.popoverClassName,y=e.popover,x=e.popoverTitle,f=e.popoverActions,g=(0,react_1.useContext)(MuiStore_1.default),h=g.status,j=g.settings,v=(0,react_1.useState)(null),S=v[0],k=v[1],C=(0,react_1.useState)(!1),b=C[0],O=C[1],q=(0,react_1.useState)(null),L=q[0],M=q[1],T=(0,react_1.useState)(!1),A=T[0],D=T[1],w=Boolean(L),I={open:w,anchorEl:L,onClose:l,elevation:a,id:"mui-status-panel-popover-".concat(t),className:m,style:__assign({marginTop:"".concat(12*(A?1:-1),"px")},p)};return(0,react_1.useEffect)(function(){var e=h.find(function(e){return e.uniqueId===t});null===S&&e&&k(e)},[h,t,S]),(0,jsx_runtime_1.jsxs)(jsx_runtime_1.Fragment,{children:[(0,jsx_runtime_1.jsx)(MuiStatus_1.default,__assign({},{id:t,tooltip:_,highlight:b||w?"primary":u,secondary:n,onClick:function(e){o&&!b&&o(),M(L&&!b?null:e.currentTarget),D(e.pageY<screen.height/2)},style:__assign(__assign({},s),{cursor:"context-menu",minWidth:"24px"})},{children:d})),(0,jsx_runtime_1.jsx)(material_1.Popper,__assign({},__assign({keepMounted:b},I),{children:(0,jsx_runtime_1.jsx)(material_1.ClickAwayListener,__assign({onClickAway:function(){return l&&!b&&l(),void(b&&j.hasLock||M(null))}},{children:(0,jsx_runtime_1.jsxs)(StyledContainer,__assign({},{elevation:a},{children:[y,(0,jsx_runtime_1.jsxs)(StyledActionsWrapper,{children:[(0,jsx_runtime_1.jsx)(StyledTypography,__assign({variant:"caption",color:"textSecondary"},{children:x})),(0,jsx_runtime_1.jsxs)(StyledActions,{children:[f,j.hasLock&&(0,jsx_runtime_1.jsx)(material_1.Tooltip,__assign({title:"Toggle keep-open"},{children:b?(0,jsx_runtime_1.jsx)(LockOutlined_1.default,{onClick:function(){return O(!b)},color:"primary",style:{fontSize:14}}):(0,jsx_runtime_1.jsx)(LockOpenOutlined_1.default,{onClick:function(){return O(!b)},style:{fontSize:14}})}))]})]})]}))}))}))]})}exports.default=default_1;