var __assign=this&&this.__assign||function(){return(__assign=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};import{jsx as _jsx,Fragment as _Fragment}from"react/jsx-runtime";import{Tooltip}from"@mui/material";import{styled}from"@mui/material/styles";import{useCallback,useContext,useEffect,useLayoutEffect,useState}from"react";import{createPortal}from"react-dom";import DataProvider,{composeDomId}from"../Store";var componentId="statusBar",backgroundColor=function(t,e){switch(e){case"primary":return t.palette.primary.main;case"secondary":return t.palette.secondary.main;default:return""}},backgroundColorHover=function(t,e){switch(e){case"primary":return t.palette.primary.dark;case"secondary":return t.palette.secondary.dark;default:return t.palette.divider}},SSpan=styled("span")(function(t){var e=t.theme;return{padding:"4px 8px",display:"flex",flexWrap:"nowrap",alignItems:"center",fontSize:"14px",gap:"".concat(e.spacing(.5)),"& > *":{fontSize:"14px !important"}}}),SDiv=styled("div")(function(t){var e=t.theme,n=t.hasclick,r=t.highlight,o=t.isdisabled;return{WebkitFontSmoothing:"auto",height:"100%",display:"flex",flex:"0 0 auto",alignItems:"center",gap:"16px",justifyContent:"center",alignSelf:"center",position:"relative",cursor:"true"===n&&"false"===o?"pointer":"",backgroundColor:backgroundColor(e,r),color:e.palette.text.primary,"& > div > *":{color:"default"!==r?"".concat(e.palette.background.default," !important"):""},"& > span > div > *":{color:"default"!==r?"".concat(e.palette.background.default," !important"):""},"&:hover":"true"===n&&"false"===o?{backgroundColor:backgroundColorHover(e,r),color:"".concat(e.palette.text.primary)}:{}}});export default function(t){var e=t.id,n=t.secondary,r=void 0!==n&&n,o=t.style,a=t.onClick,i=t.onContextMenu,l=t.disabled,s=void 0!==l&&l,u=t.highlight,c=void 0===u?"default":u,d=t.tooltip,f=t.children,p=useContext(DataProvider),m=p.status,g=p.handleStatusUpdate,h=p.handleStatusAnnouncement,v=p.handleStatusDestroy,y=useContext(DataProvider).settings.allowRightClick,x=useState(),S=x[0],b=x[1],_=useState(null),k=_[0],C=_[1],I=useState(null),j=I[0],w=I[1],D=useCallback(function(){return h({id:e,ownId:S,secondary:r,children:f})},[e,r,S,f,h]),E=useCallback(function(){v({id:e})},[e]);return useEffect(function(){S&&null!==k&&g({id:e,ownId:S,children:f})},[e,S,k,f]),useEffect(function(){e&&S&&null===k&&!m.some(function(t){return t.uniqueId===e})&&D()},[e,S,k,m,D]),useEffect(function(){var t=m.find(function(t){return t.uniqueId===e});null!==k&&(null==k?void 0:k.visible)===(null==t?void 0:t.visible)||!t||C(t)},[m,e,k]),useLayoutEffect(function(){null!==k&&w(document.getElementById(composeDomId(componentId,[r?"secondary":"primary"]))||null)},[r,k]),useEffect(function(){b((Math.random()+1).toString(36).substring(7))},[]),useEffect(function(){e||console.error("Please define an id for the status bar item")},[e]),useEffect(function(){return function(){E()}},[E]),_jsx(_Fragment,{children:null!==k&&!!e&&j&&createPortal(k.visible&&f&&_jsx(SDiv,__assign({},{id:e,direction:"row",key:"mui-status-".concat(e),onClick:function(t){void 0===a||s||(t.preventDefault(),a(t),g({id:e,ownId:S,children:f}))},onContextMenu:function(t){t.preventDefault(),y&&void 0!==i&&!s&&i(t)},style:__assign(__assign({},o),{order:k.index}),highlight:c,hasclick:(!!a).toString(),isdisabled:s.toString()},{children:d?_jsx(Tooltip,__assign({title:d,arrow:!0},{children:_jsx(SSpan,{children:f})})):_jsx(SSpan,{children:f})})),j)})}