var __assign=this&&this.__assign||function(){return(__assign=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from"react/jsx-runtime";import{Box,Button,IconButton,Tooltip,Typography}from"@mui/material";import{Resizable}from"re-resizable";import{useCallback,useContext,useEffect,useState}from"react";import{domConsoleId,localStorageKeyHeight,PlacementPosition}from"../../index.types";import DataProvider from"../../Store";import InternalActions from"../InternalActions";import{StyledCloseIcon,StyledContainer,StyledEmptyWrapper,StyledResizable,StyledStatusConsole,StyledTab,StyledTabs,StyledTabsAndActionWrapper,StyledWrapper}from"./css";var kbdId="console",domId=domConsoleId,domIdWrapper="mui-status-console-wrapper",relevantType="console";export default function(){var e=useContext(DataProvider),t=e.status,n=e.updateConsoleActiveId,o=e.updateIsConsoleOpen,i=e.handleKeyboardRegister,r=useContext(DataProvider).settings,s=r.consoleActiveId,a=r.isConsoleOpen,l=r.position,c=function(e){return e===s},d=t.filter(function(e){return e.type===relevantType}),p=useState(),u=p[0],x=p[1],m=useState("100%"),_=m[0],f=m[1],g=useCallback(function(e){var t=Number((u||"350px").replace("px",""))+e;t<125?n({id:void 0}):(x("".concat(t,"px")),f("100%"))},[u,n]);return useEffect(function(){u&&localStorage.setItem(localStorageKeyHeight,u)},[u]),useEffect(function(){var e=localStorage.getItem(localStorageKeyHeight);e&&x(e)},[]),useEffect(function(){i({id:kbdId,ascii:27,char:"",onTrigger:function(){return o()},label:"Hide/Show console"})}),_jsx(_Fragment,{children:a&&_jsx(_Fragment,{children:t.some(function(e){return e.type===relevantType})&&_jsx(StyledWrapper,__assign({},{id:domIdWrapper},{bottom:String(l===PlacementPosition.BOTTOM)},{children:_jsx(Resizable,__assign({enable:{left:!1,right:!1,top:l===PlacementPosition.BOTTOM,bottom:l===PlacementPosition.TOP,topRight:!1,bottomRight:!1,bottomLeft:!1,topLeft:!1},onResizeStop:function(e,t,n,o){return g(o.height)},style:{display:"flex",flexDirection:"column"},minHeight:"75px",maxHeight:"950px",defaultSize:{width:_,height:u||"350px"}},{children:_jsx(StyledResizable,{children:d.some(function(e){return e.uniqueId===s})?_jsx(_Fragment,{children:_jsxs(StyledContainer,__assign({position:l.toString()},{children:[_jsxs(StyledTabsAndActionWrapper,{children:[_jsx(StyledTabs,{children:d.map(function(e){var t=e.uniqueId,o=e.options,i=e.children;return _jsx(StyledTab,__assign({},{key:t,variant:"caption",onClick:function(){return n({id:t})},activated:c(t).toString()},{children:_jsxs(Box,__assign({display:"flex",flexDirection:"row",flexWrap:"nowrap",style:{gap:"8px"}},{children:[i||t,_jsx(InternalActions,{actions:o.actions,fontSize:"14px"})]}))}))})}),_jsx(Tooltip,__assign({},{title:"Close console section"},{arrow:!0,placement:l===PlacementPosition.BOTTOM?"top":"bottom"},{children:_jsx(IconButton,__assign({onClick:function(){return n({})},size:"small"},{children:_jsx(StyledCloseIcon,{style:{fontSize:"16px"}})}))}))]}),_jsx(StyledStatusConsole,__assign({},{id:domId}))]}))}):_jsx(StyledEmptyWrapper,{children:_jsx(Box,__assign({display:"flex",flexDirection:"row",style:{gap:"8px"}},{children:t.filter(function(e){return e.type===relevantType}).map(function(e){return _jsx(Button,__assign({style:{padding:"24px",textTransform:"unset"},variant:"outlined",color:"inherit",onClick:function(){return n({id:e.uniqueId})}},{children:_jsxs(Box,__assign({display:"flex",flexDirection:"column",style:{gap:"8px"}},{children:[e.children,_jsx(Typography,__assign({variant:"caption",color:"textSecondary"},{children:e.options.title}))]}))}),e.uniqueId)})}))})})}))}))})})}