var __assign=this&&this.__assign||function(){return(__assign=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from"react/jsx-runtime";import{Autocomplete,Box,ClickAwayListener,Paper,TextField,Typography}from"@mui/material";import{cloneElement,useContext,useEffect,useState}from"react";import KeyboardHelper from"../../Shortcuts/KeyboardHelper";import DataProvider from"../../Store";import InternalHeader from"../InternalHeader";import{StyledHighlight}from"./css";var kbdId="commands";export default function(){var e=useContext(DataProvider),t=e.handleKeyboardRegister,n=e.handleCallCommand,i=e.commands,r=useState(!1),s=r[0],o=r[1],a=useState(""),l=a[0],c=a[1];return useEffect(function(){t({id:kbdId,shiftKey:!0,char:"P",metaKey:!0,onTrigger:function(){return o(function(e){return!e})},label:"Hide/Show quick commands"})}),_jsx(_Fragment,{children:s&&_jsx("div",__assign({style:{position:"absolute",top:"32px",display:"flex",justifyContent:"center",width:"100%"}},{children:_jsx(ClickAwayListener,__assign({onClickAway:function(){return o(!1)}},{children:_jsx(Paper,__assign({style:{width:"60vw",maxWidth:"750px",padding:"12px",borderRadius:"8px"},elevation:8},{children:_jsx(Autocomplete,{disablePortal:!0,open:!0,autoHighlight:!0,inputValue:l,clearOnEscape:!0,onClose:function(e,t){"escape"===t&&o(!1)},autoSelect:!0,onInputChange:function(e,t){t&&(e&&"blur"!==(null==e?void 0:e.type)||!e)&&c(t)},onChange:function(e,t){t&&(e&&"blur"!==(null==e?void 0:e.type)||!e)&&(n(t.id),o(!1))},fullWidth:!0,openOnFocus:!0,style:{position:"relative"},PaperComponent:function(e){var t=e.children;return _jsxs(Paper,__assign({style:{position:"relative"}},{children:[_jsx("div",__assign({style:{position:"relative"}},{children:t})),_jsx(InternalHeader,{id:"quickCommands",noDefaults:!0,title:"Quick commands"})]}))},renderOption:function(e,t){return _jsx("div",__assign({},e,{onContextMenu:function(e){return e.preventDefault()}},{children:_jsxs(Box,__assign({display:"flex",justifyContent:"space-between",style:{width:"100%"},alignItems:"center"},{children:[_jsxs(Box,__assign({display:"flex",style:{gap:"8px"},flexWrap:"nowrap",alignItems:"center"},{children:[cloneElement(t.icon,{style:{fontSize:"16px"}}),(n=t.label,i=l,r=n.split(new RegExp("(".concat(i,")"),"gi")),_jsx(Typography,__assign({variant:"subtitle2",color:"textSecondary"},{children:r.map(function(e,t){return _jsx(StyledHighlight,__assign({highlight:e.toLowerCase()===i.toLowerCase()?"true":"false"},{children:e}),t)})})))]})),t.shortcutId&&_jsx(_Fragment,{children:_jsx(KeyboardHelper,{shortcutId:t.shortcutId,asChip:!0})})]}))}));var n,i,r},id:"combo-box-demo",options:i,renderInput:function(e){return _jsx(TextField,__assign({autoFocus:!0},e,{fullWidth:!0,size:"small",label:"Commands"}))}})}))}))}))})}