var __assign=this&&this.__assign||function(){return(__assign=Object.assign||function(n){for(var e,t=1,r=arguments.length;t<r;t++)for(var i in e=arguments[t])Object.prototype.hasOwnProperty.call(e,i)&&(n[i]=e[i]);return n}).apply(this,arguments)},__spreadArray=this&&this.__spreadArray||function(n,e,t){if(t||2===arguments.length)for(var r,i=0,a=e.length;i<a;i++)!r&&i in e||(r||(r=Array.prototype.slice.call(e,0,i)),r[i]=e[i]);return n.concat(r||Array.prototype.slice.call(e))};import{jsx as _jsx}from"react/jsx-runtime";import{createContext,useCallback,useEffect,useState}from"react";import{PlacementPosition}from"../index.types";import Wrapper from"../internal/Wrapper";import{lognPackage,logPackage}from"../utils/logger";var domIdBase="mui-status";export var composeDomId=function(n,e){var t=e.join("-");return"".concat(domIdBase,"-").concat(n,"-").concat(t)};var packageName="mui-industrial",keyboardOverridesStorageKey="".concat(packageName,".keyboard.overrides"),initialSettings={position:PlacementPosition.TOP,expand:!0,statusBarAnnounced:!1,allowRightClick:!0,debug:!1,capsLock:!1,hasLock:!0,hasBorder:!0,variant:"default",isConsoleFixed:!1,isConsoleOpen:!1},valOrDefault=function(n,e){return void 0===n?e:n},DataContext=createContext({}),IndustrialProvider=function(n){var e=n.expand,t=n.hasLock,r=n.position,i=void 0===r?PlacementPosition.TOP:r,a=n.allowRightClick,o=n.hasBorder,s=void 0===o||o,u=n.fullWidth,d=void 0!==u&&u,c=n.justifyContent,l=void 0===c?"space-between":c,f=n.debug,g=n.children,p=n.style,_=n.size,y=void 0===_?"small":_,v=n.variant,h=void 0===v?"default":v,m=useState([]),b=m[0],k=m[1],S=useState([]),I=S[0],C=S[1],A=useState([]),O=A[0],x=A[1],K=useState([]),w=K[0],T=K[1],R=useState(initialSettings),D=R[0],P=R[1],j=function(n){D.debug&&console.log(n)},q=useCallback(function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];D.debug&&logPackage.apply(void 0,n)},[D.debug]),B=useCallback(function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];D.debug&&lognPackage.apply(void 0,n)},[D.debug]);function E(n,e,t,r){return"".concat(n,"-").concat(e,"-").concat(t||"empty","-").concat(r||"empty")}function N(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return n.join("-")}var U=function(n){var e=n.id,t=n.label,r=n.ascii,i=n.char,a=n.altKey,o=n.ctrlKey,s=n.metaKey,u=n.shiftKey,d=n.onTrigger,c=n.insensitive,l=w.find(function(n){return n.id===e});if(!l||E(l.id,l.label,l.ascii,l.char)!==E(e,t,r,i)){var f,g={id:e,label:t,char:i,ascii:r,onTrigger:d,altKey:a,ctrlKey:o,metaKey:s,shiftKey:u,insensitive:c},p=localStorage.getItem(keyboardOverridesStorageKey);if(p)try{(f=JSON.parse(p).filter(function(n){return n.id===e}).filter(function(n){return JSON.stringify(n.original)===JSON.stringify(g)}).find(function(n){return n}))&&(g=__assign(__assign({},f),{onTrigger:d,original:g}))}catch(n){q("‚ùå Failed to parse keyboard overrides",n)}T(function(n){var t=__spreadArray(__spreadArray([],n.filter(function(n){return n.id!==e}),!0),[g],!1);return q("‚ûï Registered keyboard",e,t),t})}},L=function(n){var e=n.id,t=n.shortcutId,r=n.label,i=n.onTrigger,a=n.disabled,o=n.hidden,s=n.icon,u=n.order,d=n.tooltip,c=O.find(function(n){return n.id===e});if(!c||N(c.id,c.shortcutId,c.label,c.tooltip)!==N(e,t,r,d)){var l={id:e,label:r,shortcutId:t,onTrigger:i,disabled:a,hidden:o,icon:s,order:u,tooltip:d};x(function(n){var t=__spreadArray(__spreadArray([],n.filter(function(n){return n.id!==e}),!0),[l],!1);return q("‚ûï Registered command",e,t),t})}};useEffect(function(){},[]),useEffect(function(){P(function(n){return __assign(__assign({},n),{expand:e||initialSettings.expand,position:i,justifyContent:l,hasBorder:s,size:y,variant:h,fullWidth:d,allowRightClick:a||initialSettings.allowRightClick,debug:f||initialSettings.debug,hasLock:valOrDefault(t,initialSettings.hasLock)})})},[a,d,h,s,y,l,e,i,f,t]);var J=useCallback(function(n,e){D.debug&&(B(n,e.length),q(e.length>0?__spreadArray([],e,!0):"No entries found."))},[D.debug,q,B]);return useEffect(function(){return J("üóÑÔ∏è Status",b)},[b,J]),useEffect(function(){return J("üìü Snackbar",I)},[I,J]),useEffect(function(){return J("ü´ô Shortcuts",w)},[w,J]),useEffect(function(){return J("üéØ Commands",O)},[O,J]),_jsx(DataContext.Provider,__assign({value:{settings:D,updateConsoleActiveId:function(n){var e=n.id;P(function(n){return __assign(__assign({},n),{consoleActiveId:e||void 0,isConsoleOpen:!!e})})},updateIsConsoleOpen:function(){P(function(n){return __assign(__assign({},n),{isConsoleOpen:!n.isConsoleOpen})})},updateIsConsoleClosed:function(){P(function(n){return __assign(__assign({},n),{isConsoleOpen:!1})})},triggerStatusBarAnnounced:function(){D.statusBarAnnounced||P(function(n){return __assign(__assign({},n),{statusBarAnnounced:!0})})},commands:O,handleCommandRegister:L,handleCommandsRegister:function(n){n.forEach(function(n){L(n)})},handleCallCommand:function(n){var e=O.find(function(e){return e.id===n});e&&(null==e?void 0:e.onTrigger)&&(q("üí° Triggered command",e.id),null==e||e.onTrigger())},handleCommandsDeRegister:function(n){x(function(e){var t=__spreadArray([],e.filter(function(e){return!n.some(function(n){return n===e.id})}),!0);return q("‚ûñ Destroyed commands",n,t),t})},shortcuts:w,handleKeyboardRegister:U,handleKeyboardsRegister:function(n){n.forEach(function(n){U(n)})},handleKeyboardDeRegister:function(n){T(function(e){var t=__spreadArray([],e.filter(function(e){return e.id!==n}),!0);return q("‚ûñ Destroyed keyboard",n,t),t})},handleKeyboardsDeRegister:function(n){T(function(e){var t=__spreadArray([],e.filter(function(e){return!n.some(function(n){return n===e.id})}),!0);return q("‚ûñ Destroyed keyboards",n,t),t})},handleKeyboardUpdate:function(n,e){T(function(t){var r=__spreadArray([],t.map(function(t){return t.id===n?__assign(__assign({},e),{original:t.original||t}):t}),!0);return localStorage.setItem(keyboardOverridesStorageKey,JSON.stringify(r)),q("‚öôÔ∏è Updated keyboard",n,r),r})},handleKeyboardRevert:function(n){T(function(e){var t=__spreadArray([],e.map(function(e){return e.id===n&&e.original?__assign({},e.original):e}),!0);return localStorage.setItem(keyboardOverridesStorageKey,JSON.stringify(t)),q("‚öôÔ∏è Reverted keyboard to original settings",n,t),t})},handleKeyboardTrigger:function(n){var e=w.find(function(e){return e.id===n});e&&(null==e?void 0:e.onTrigger)&&(q("üí° Triggered keyboard",e.id),null==e||e.onTrigger())},handleKeyboardGetLabel:function(n){var e;return null===(e=w.find(function(e){return e.id===n}))||void 0===e?void 0:e.label},snackbar:I,handleSnackbarRegister:function(n){var e=n.severity,t=n.actions,r=n.source,i=n.message,a=n.code,o=n.autoHideDuration,s=Math.random().toString(36).substring(7);console.log("registed snackbar",s),C(function(n){return __spreadArray(__spreadArray([],n.filter(function(n){return n.id!==s}),!0),[{id:s,open:!0,severity:e,actions:t,source:r,message:i,code:a,autoHideDuration:o||5e3}],!1)})},handleSnackbarCleaning:function(){C(function(){return[]})},status:b,handleStatusVisibilityToggle:function(n){var e=n.id;k(function(n){return n.map(function(n){return n.uniqueId===e?__assign(__assign({},n),{visible:!n.visible}):n})})},handleStatusKeepOpenToggle:function(n){var e=n.id;k(function(n){return n.map(function(n){return n.uniqueId===e?__assign(__assign({},n),{keepOpen:!n.keepOpen}):n})})},handleStatusTypeUpdate:function(n){var e=n.id,t=n.type;D.debug&&console.info("mui-status: üÜó Updated type for id: [".concat(e,"] to: [").concat(t,"]")),k(function(n){return n.map(function(n){return n.uniqueId===e?__assign(__assign({},n),{type:t}):n})})},handleStatusConsoleTitleUpdate:function(n){var e=n.id,t=n.title;D.debug&&console.info("mui-status: üÜó Updated console title for id: [".concat(e,"] to: [").concat(t,"]")),k(function(n){return n.map(function(n){return n.uniqueId===e?__assign(__assign({},n),{title:t}):n})})},handleStatusUpdate:function(n){var e=n.id,t=n.ownId,r=n.children;k(function(n){var i=n.find(function(n){return n.uniqueId===e});return(null==i?void 0:i.ownId)!==t?(D.debug&&console.error("mui-status: ‚ùå Faulty status update captured for: [".concat(e,"] & ownId: [").concat(t,"], but expected ownId: [").concat(null==i?void 0:i.ownId,"]")),n):n.map(function(n){return n.uniqueId===e&&n.ownId===t?__assign(__assign({},n),{children:r}):n})})},handleStatusAnnouncement:function(n){var e=n.id,t=n.ownId,r=n.secondary,i=n.children,a=n.options;k(function(n){var o=n.find(function(n){return n.uniqueId===e&&n.ownId!==t});return o?(j("mui-status: ‚ùå Status entry already registered with id: [".concat(e,"] & ownId: [").concat(t,"], but was proposed ownId [").concat(o.ownId,"]")),n):(q("‚ûï Registered status",e,t,r,i,a),__spreadArray(__spreadArray([],n.filter(function(n){return n.uniqueId!==e}),!0),[{index:n.length,uniqueId:e,ownId:t,options:a,keepOpen:!1,visible:!0,secondary:r,children:i}],!1))})},handleStatusDestroy:function(n){var e=n.id;k(function(n){return __spreadArray([],n.filter(function(n){return n.uniqueId!==e}),!0)})},logDebug:j}},{children:_jsx(Wrapper,__assign({},{children:g,style:p}))}))};export default DataContext;export{IndustrialProvider};