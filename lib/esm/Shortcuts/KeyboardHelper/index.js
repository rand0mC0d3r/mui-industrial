var __assign=this&&this.__assign||function(){return(__assign=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)};import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from"react/jsx-runtime";import{Tooltip,Typography}from"@mui/material";import{useContext,useEffect,useState}from"react";import DataProvider from"../../Store";import Component from"./Component";import{StyledKey,StyledListOfKeys,StyledOverrideWrapper}from"./css";var shortcutString=function(t){return[(null==t?void 0:t.shiftKey)&&"⇧",(null==t?void 0:t.ctrlKey)&&"⌃",(null==t?void 0:t.altKey)&&"⌥",(null==t?void 0:t.metaKey)&&"⌘",null==t?void 0:t.char,(null==t?void 0:t.ascii)&&"Ascii ".concat(t.ascii)].filter(Boolean).join(" ")},shortcutStringNg=function(t){return _jsx(StyledListOfKeys,{children:[(null==t?void 0:t.shiftKey)&&"⇧",(null==t?void 0:t.ctrlKey)&&"⌃",(null==t?void 0:t.altKey)&&"⌥",(null==t?void 0:t.metaKey)&&"⌘",null==t?void 0:t.char,(null==t?void 0:t.ascii)&&"Ascii (".concat(t.ascii,")")].filter(Boolean).map(function(t){return _jsx(StyledKey,__assign({ascii:(t||"").includes("(").toString(),elevation:1},{children:t}),"char-".concat(t))})})},baseTooltip=function(t){return"".concat(t&&"".concat(t.label," -")," ").concat(shortcutString(t))};export default function(t){var e,n=t.shortcutId,i=t.asChip,r=void 0!==i&&i,o=t.hasTooltip,s=void 0!==o&&o,a=t.hasOverride,l=void 0!==a&&a,c=t.style,u=useContext(DataProvider).shortcuts,d=useState(),p=d[0],_=d[1],f=useState(null),h=f[0],g=f[1],v=useState(baseTooltip),y=v[0],m=v[1],x=Boolean(h),S=x?"simple-popover":void 0,j=function(){g(null)},K=_jsx("div",__assign({style:{userSelect:"none",display:"flex",alignItems:"center",gap:"4px"}},{children:shortcutStringNg(p)})),O=_jsx(Typography,__assign({style:__assign(__assign({},c),{userSelect:"none",lineHeight:"1",display:"flex",alignItems:"center"}),variant:"caption",color:"inherit"},{children:shortcutString(p)}));return useEffect(function(){var t=baseTooltip(p);m(function(){return l?"".concat(t," - Right-Click to Override"):t})},[l,p]),useEffect(function(){_(u.find(function(t){return t.id===n}))},[n,u]),_jsx(_Fragment,{children:n&&p&&function(t){return l?_jsxs(StyledOverrideWrapper,__assign({onContextMenu:function(t){t.preventDefault(),g(t.currentTarget)}},{children:[p&&_jsx(Component,__assign({},{idPopper:S,anchorEl:h,open:x,handleClose:j,shortcutId:n,shortcutObject:p})),t]})):t}((e=r?K:O,s||l?_jsx(Tooltip,__assign({title:_jsx("span",__assign({style:{userSelect:"none"}},{children:y})),placement:"right",arrow:!0},{children:_jsx("span",__assign({style:c},{children:e}))})):e))})}