var __assign=this&&this.__assign||function(){return(__assign=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from"react/jsx-runtime";import LockOpenOutlinedIcon from"@mui/icons-material/LockOpenOutlined";import LockOutlinedIcon from"@mui/icons-material/LockOutlined";import{alpha,ClickAwayListener,Popper,Tooltip,Typography}from"@mui/material";import{styled}from"@mui/material/styles";import{useContext,useEffect,useState}from"react";import MuiStatus from"../MuiStatus";import DataProvider from"../MuiStore";var StyledActionsWrapper=styled("div")(function(e){var t=e.theme;return{padding:"8px",display:"flex",justifyContent:"space-between",borderTop:"1px solid ".concat(t.palette.divider),userSelect:"none",alignItems:"center"}}),StyledActions=styled("div")(function(e){var t=e.theme;return{display:"flex",gap:"".concat(t.shape.borderRadius,"px"),justifyContent:"flex-end",alignItems:"center"}}),StyledContainer=styled("div")(function(e){var t=e.theme,n=e.elevation;return{display:"flex",alignItems:"stretch",flexDirection:"column",backgroundColor:"".concat(alpha(t.palette.background.default,.75)),backdropFilter:"blur(8px)",borderRadius:"".concat(t.shape.borderRadius,"px"),margin:"".concat(t.spacing(.5)," 0px"),padding:t.spacing(.5),border:"1px solid ".concat(t.palette.divider),boxShadow:t.shadows[n]}}),StyledTypography=styled(Typography)(function(){return{lineHeight:1}});export default function(e){var t=e.id,n=e.secondary,i=void 0!==n&&n,o=e.elevation,r=void 0===o?2:o,a=e.style,s=e.onClick,l=e.onClose,c=e.highlight,p=e.tooltip,d=void 0===p?"":p,u=e.children,g=e.popoverStyle,m=e.popoverClassName,y=e.popover,h=e.popoverTitle,_=e.popoverActions,f=useContext(DataProvider),x=f.status,v=f.settings,S=useState(null),j=S[0],k=S[1],C=useState(!1),b=C[0],O=C[1],T=useState(null),L=T[0],A=T[1],I=useState(!1),w=I[0],M=I[1],P=Boolean(L),F={open:P,anchorEl:L,onClose:l,elevation:r,id:"mui-status-panel-popover-".concat(t),className:m,style:__assign({marginTop:"".concat(12*(w?1:-1),"px")},g)};return useEffect(function(){var e=x.find(function(e){return e.uniqueId===t});null===j&&e&&k(e)},[x,t,j]),_jsxs(_Fragment,{children:[_jsx(MuiStatus,__assign({},{id:t,tooltip:d,highlight:b||P?"primary":c,secondary:i,onClick:function(e){s&&!b&&s(),A(L&&!b?null:e.currentTarget),M(e.pageY<screen.height/2)},style:__assign(__assign({},a),{cursor:"context-menu",minWidth:"24px"})},{children:u})),_jsx(Popper,__assign({},__assign({keepMounted:b},F),{children:_jsx(ClickAwayListener,__assign({onClickAway:function(){return l&&!b&&l(),void(b&&v.hasLock||A(null))}},{children:_jsxs(StyledContainer,__assign({},{elevation:r},{children:[y,_jsxs(StyledActionsWrapper,{children:[_jsx(StyledTypography,__assign({variant:"caption",color:"textSecondary"},{children:h})),_jsxs(StyledActions,{children:[_,v.hasLock&&_jsx(Tooltip,__assign({title:"Toggle keep-open"},{children:b?_jsx(LockOutlinedIcon,{onClick:function(){return O(!b)},color:"primary",style:{fontSize:14}}):_jsx(LockOpenOutlinedIcon,{onClick:function(){return O(!b)},style:{fontSize:14}})}))]})]})]}))}))}))]})}